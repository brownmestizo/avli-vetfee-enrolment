var mycallback=function(a,b){$segment=$(".optional"+b),a?$segment.show():$segment.hide()};!function(a){"use strict";a.Zebra_DatePicker=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N={always_visible:!1,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],days_abbr:!1,direction:0,disabled_dates:!1,enabled_dates:!1,first_day_of_week:1,format:"Y-m-d",header_captions:{days:"F, Y",months:"Y",years:"Y1 - Y2"},header_navigation:["&#171;","&#187;"],inside:!0,lang_clear_date:"Clear date",months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_abbr:!1,offset:[5,-5],pair:!1,readonly_element:!0,select_other_months:!1,show_clear_date:0,show_icon:!0,show_other_months:!0,show_select_today:"Today",show_week_number:!1,start_date:!1,strict:!1,view:"days",weekend_days:[0,6],zero_pad:!1,onChange:null,onClear:null,onSelect:null},O=this;O.settings={};var P=a(b),Q=function(b){if(!b){O.settings=a.extend({},N,c);for(var y in P.data())0===y.indexOf("zdp_")&&(y=y.replace(/^zdp\_/,""),void 0!==N[y]&&(O.settings[y]="pair"==y?a(P.data("zdp_"+y)):P.data("zdp_"+y)))}O.settings.readonly_element&&P.attr("readonly","readonly");var E={days:["d","j","D"],months:["F","m","M","n","t"],years:["o","Y","y"]},F=!1,G=!1,Q=!1,T=null;for(T in E)a.each(E[T],function(a,b){O.settings.format.indexOf(b)>-1&&("days"==T?F=!0:"months"==T?G=!0:"years"==T&&(Q=!0))});H=F&&G&&Q?["years","months","days"]:!F&&G&&Q?["years","months"]:F||G||!Q?F||!G||Q?["years","months","days"]:["months"]:["years"],-1==a.inArray(O.settings.view,H)&&(O.settings.view=H[H.length-1]),x=[],w=[];for(var U,V=0;2>V;V++)U=0===V?O.settings.disabled_dates:O.settings.enabled_dates,a.isArray(U)&&U.length>0&&a.each(U,function(){for(var b=this.split(" "),c=0;4>c;c++){b[c]||(b[c]="*"),b[c]=b[c].indexOf(",")>-1?b[c].split(","):new Array(b[c]);for(var d=0;d<b[c].length;d++)if(b[c][d].indexOf("-")>-1){var e=b[c][d].match(/^([0-9]+)\-([0-9]+)/);if(null!==e){for(var f=eb(e[1]);f<=eb(e[2]);f++)-1==a.inArray(f,b[c])&&b[c].push(f+"");b[c].splice(d,1)}}for(d=0;d<b[c].length;d++)b[c][d]=isNaN(eb(b[c][d]))?b[c][d]:eb(b[c][d])}0===V?x.push(b):w.push(b)});var W,X,Y=new Date,_=O.settings.reference_date?O.settings.reference_date:P.data("zdp_reference_date")&&void 0!==P.data("zdp_reference_date")?P.data("zdp_reference_date"):Y;if(z=void 0,A=void 0,o=_.getMonth(),l=Y.getMonth(),p=_.getFullYear(),m=Y.getFullYear(),q=_.getDate(),n=Y.getDate(),O.settings.direction===!0)z=_;else if(O.settings.direction===!1)A=_,D=A.getMonth(),C=A.getFullYear(),B=A.getDate();else if(!a.isArray(O.settings.direction)&&$(O.settings.direction)&&eb(O.settings.direction)>0||a.isArray(O.settings.direction)&&((W=R(O.settings.direction[0]))||O.settings.direction[0]===!0||$(O.settings.direction[0])&&O.settings.direction[0]>0)&&((X=R(O.settings.direction[1]))||O.settings.direction[1]===!1||$(O.settings.direction[1])&&O.settings.direction[1]>=0))z=W?W:new Date(p,o,q+eb(a.isArray(O.settings.direction)?O.settings.direction[0]===!0?0:O.settings.direction[0]:O.settings.direction)),o=z.getMonth(),p=z.getFullYear(),q=z.getDate(),X&&+X>=+z?A=X:!X&&O.settings.direction[1]!==!1&&a.isArray(O.settings.direction)&&(A=new Date(p,o,q+eb(O.settings.direction[1]))),A&&(D=A.getMonth(),C=A.getFullYear(),B=A.getDate());else if(!a.isArray(O.settings.direction)&&$(O.settings.direction)&&eb(O.settings.direction)<0||a.isArray(O.settings.direction)&&(O.settings.direction[0]===!1||$(O.settings.direction[0])&&O.settings.direction[0]<0)&&((W=R(O.settings.direction[1]))||$(O.settings.direction[1])&&O.settings.direction[1]>=0))A=new Date(p,o,q+eb(a.isArray(O.settings.direction)?O.settings.direction[0]===!1?0:O.settings.direction[0]:O.settings.direction)),D=A.getMonth(),C=A.getFullYear(),B=A.getDate(),W&&+A>+W?z=W:!W&&a.isArray(O.settings.direction)&&(z=new Date(C,D,B-eb(O.settings.direction[1]))),z&&(o=z.getMonth(),p=z.getFullYear(),q=z.getDate());else if(a.isArray(O.settings.disabled_dates)&&O.settings.disabled_dates.length>0)for(var cb in x)if("*"==x[cb][0]&&"*"==x[cb][1]&&"*"==x[cb][2]&&"*"==x[cb][3]){var gb=[];if(a.each(w,function(){var a=this;"*"!=a[2][0]&&gb.push(parseInt(a[2][0]+("*"==a[1][0]?"12":db(a[1][0],2))+("*"==a[0][0]?"*"==a[1][0]?"31":new Date(a[2][0],a[1][0],0).getDate():db(a[0][0],2)),10))}),gb.sort(),gb.length>0){var ib=(gb[0]+"").match(/([0-9]{4})([0-9]{2})([0-9]{2})/);p=parseInt(ib[1],10),o=parseInt(ib[2],10)-1,q=parseInt(ib[3],10)}break}if(Z(p,o,q)){for(;Z(p);)z?(p++,o=0):(p--,o=11);for(;Z(p,o);)z?(o++,q=1):(o--,q=new Date(p,o+1,0).getDate()),o>11?(p++,o=0,q=1):0>o&&(p--,o=11,q=new Date(p,o+1,0).getDate());for(;Z(p,o,q);)z?q++:q--,Y=new Date(p,o,q),p=Y.getFullYear(),o=Y.getMonth(),q=Y.getDate();Y=new Date(p,o,q),p=Y.getFullYear(),o=Y.getMonth(),q=Y.getDate()}var jb=R(P.val()||(O.settings.start_date?O.settings.start_date:""));if(jb&&O.settings.strict&&Z(jb.getFullYear(),jb.getMonth(),jb.getDate())&&P.val(""),b||fb(z),!O.settings.always_visible){if(!b){if(O.settings.show_icon){"firefox"==hb.name&&P.is('input[type="text"]')&&"inline"==P.css("display")&&P.css("display","inline-block");var kb=jQuery('<span class="Zebra_DatePicker_Icon_Wrapper"></span>').css({display:P.css("display"),position:"static"==P.css("position")?"relative":P.css("position"),"float":P.css("float"),top:P.css("top"),right:P.css("right"),bottom:P.css("bottom"),left:P.css("left")});P.wrap(kb).css({position:"relative",top:"auto",right:"auto",bottom:"auto",left:"auto"}),f=jQuery('<button type="button" class="Zebra_DatePicker_Icon'+("disabled"==P.attr("disabled")?" Zebra_DatePicker_Icon_Disabled":"")+'">Pick a date</button>'),O.icon=f,I=f.add(P)}else I=P;I.bind("click",function(a){a.preventDefault(),P.attr("disabled")||("none"!=e.css("display")?O.hide():O.show())}),void 0!==f&&f.insertAfter(P)}if(void 0!==f){f.attr("style",""),O.settings.inside&&f.addClass("Zebra_DatePicker_Icon_Inside");var lb=P.outerWidth(),mb=P.outerHeight(),nb=parseInt(P.css("marginLeft"),10)||0,ob=parseInt(P.css("marginTop"),10)||0,pb=f.outerWidth(),qb=f.outerHeight(),rb=parseInt(f.css("marginLeft"),10)||0,sb=parseInt(f.css("marginRight"),10)||0;f.css(O.settings.inside?{top:ob+(mb-qb)/2,left:nb+(lb-pb-sb)}:{top:ob+(mb-qb)/2,left:nb+lb+rb})}}if(L=O.settings.show_select_today!==!1&&a.inArray("days",H)>-1&&!Z(m,l,n)?O.settings.show_select_today:!1,!b){a(window).bind("resize.Zebra_DatePicker",function(){O.hide(),void 0!==f&&(clearTimeout(M),M=setTimeout(function(){O.update()},100))});var tb='<div class="Zebra_DatePicker"><table class="dp_header"><tr><td class="dp_previous">'+O.settings.header_navigation[0]+'</td><td class="dp_caption">&#032;</td><td class="dp_next">'+O.settings.header_navigation[1]+'</td></tr></table><table class="dp_daypicker"></table><table class="dp_monthpicker"></table><table class="dp_yearpicker"></table><table class="dp_footer"><tr><td class="dp_today"'+(O.settings.show_clear_date!==!1?' style="width:50%"':"")+">"+L+'</td><td class="dp_clear"'+(L!==!1?' style="width:50%"':"")+">"+O.settings.lang_clear_date+"</td></tr></table></div>";e=a(tb),O.datepicker=e,g=a("table.dp_header",e),h=a("table.dp_daypicker",e),i=a("table.dp_monthpicker",e),j=a("table.dp_yearpicker",e),K=a("table.dp_footer",e),J=a("td.dp_today",K),k=a("td.dp_clear",K),O.settings.always_visible?P.attr("disabled")||(O.settings.always_visible.append(e),O.show()):a("body").append(e),e.delegate("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked, .dp_week_number)","mouseover",function(){a(this).addClass("dp_hover")}).delegate("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked, .dp_week_number)","mouseout",function(){a(this).removeClass("dp_hover")}),S(a("td",g)),a(".dp_previous",g).bind("click",function(){a(this).hasClass("dp_blocked")||("months"==d?s--:"years"==d?s-=12:--r<0&&(r=11,s--),ab())}),a(".dp_caption",g).bind("click",function(){d="days"==d?a.inArray("months",H)>-1?"months":a.inArray("years",H)>-1?"years":"days":"months"==d?a.inArray("years",H)>-1?"years":a.inArray("days",H)>-1?"days":"months":a.inArray("days",H)>-1?"days":a.inArray("months",H)>-1?"months":"years",ab()}),a(".dp_next",g).bind("click",function(){a(this).hasClass("dp_blocked")||("months"==d?s++:"years"==d?s+=12:12==++r&&(r=0,s++),ab())}),h.delegate("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_week_number)","click",function(){O.settings.select_other_months&&null!==(ib=a(this).attr("class").match(/date\_([0-9]{4})(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])/))?bb(ib[1],ib[2]-1,ib[3],"days",a(this)):bb(s,r,eb(a(this).html()),"days",a(this))}),i.delegate("td:not(.dp_disabled)","click",function(){var b=a(this).attr("class").match(/dp\_month\_([0-9]+)/);r=eb(b[1]),-1==a.inArray("days",H)?bb(s,r,1,"months",a(this)):(d="days",O.settings.always_visible&&P.val(""),ab())}),j.delegate("td:not(.dp_disabled)","click",function(){s=eb(a(this).html()),-1==a.inArray("months",H)?bb(s,1,1,"years",a(this)):(d="months",O.settings.always_visible&&P.val(""),ab())}),a(J).bind("click",function(b){b.preventDefault(),bb(m,l,n,"days",a(".dp_current",h)),O.settings.always_visible&&O.show(),O.hide()}),a(k).bind("click",function(b){b.preventDefault(),P.val(""),O.settings.always_visible?(t=null,u=null,v=null,a("td.dp_selected",e).removeClass("dp_selected")):(t=null,u=null,v=null,r=null,s=null),O.hide(),O.settings.onClear&&"function"==typeof O.settings.onClear&&O.settings.onClear.call(P,P)}),O.settings.always_visible||a(document).bind({"mousedown.Zebra_DatePicker":function(b){if("block"==e.css("display")){if(O.settings.show_icon&&a(b.target).get(0)===f.get(0))return!0;0===a(b.target).parents().filter(".Zebra_DatePicker").length&&O.hide()}},"keyup.Zebra_DatePicker":function(a){"block"==e.css("display")&&27==a.which&&O.hide()}}),ab()}};O.destroy=function(){void 0!==O.icon&&O.icon.remove(),O.datepicker.remove(),a(document).unbind("keyup.Zebra_DatePicker"),a(document).unbind("mousedown.Zebra_DatePicker"),a(window).unbind("resize.Zebra_DatePicker"),P.removeData("Zebra_DatePicker")},O.hide=function(){O.settings.always_visible||(Y("hide"),e.hide())},O.show=function(){d=O.settings.view;var b=R(P.val()||(O.settings.start_date?O.settings.start_date:""));if(b?(u=b.getMonth(),r=b.getMonth(),v=b.getFullYear(),s=b.getFullYear(),t=b.getDate(),Z(v,u,t)&&(O.settings.strict&&P.val(""),r=o,s=p)):(r=o,s=p),ab(),O.settings.always_visible)e.show();else{var c=e.outerWidth(),g=e.outerHeight(),h=(void 0!==f?f.offset().left+f.outerWidth(!0):P.offset().left+P.outerWidth(!0))+O.settings.offset[0],i=(void 0!==f?f.offset().top:P.offset().top)-g+O.settings.offset[1],j=a(window).width(),k=a(window).height(),l=a(window).scrollTop(),m=a(window).scrollLeft();h+c>m+j&&(h=m+j-c),m>h&&(h=m),i+g>l+k&&(i=l+k-g),l>i&&(i=l),e.css({left:h,top:i}),e.fadeIn("explorer"==hb.name&&hb.version<9?0:150,"linear"),Y()}},O.update=function(b){O.original_direction&&(O.original_direction=O.direction),O.settings=a.extend(O.settings,b),Q(!0)};var R=function(b){if(b+="",""!==a.trim(b)){for(var c=T(O.settings.format),d=["d","D","j","l","N","S","w","F","m","M","n","Y","y"],e=[],f=[],g=null,h=null,i=0;i<d.length;i++)(g=c.indexOf(d[i]))>-1&&e.push({character:d[i],position:g});if(e.sort(function(a,b){return a.position-b.position}),a.each(e,function(a,b){switch(b.character){case"d":f.push("0[1-9]|[12][0-9]|3[01]");break;case"D":f.push("[a-z]{3}");break;case"j":f.push("[1-9]|[12][0-9]|3[01]");break;case"l":f.push("[a-z]+");break;case"N":f.push("[1-7]");break;case"S":f.push("st|nd|rd|th");break;case"w":f.push("[0-6]");break;case"F":f.push("[a-z]+");break;case"m":f.push("0[1-9]|1[012]+");break;case"M":f.push("[a-z]{3}");break;case"n":f.push("[1-9]|1[012]");break;case"Y":f.push("[0-9]{4}");break;case"y":f.push("[0-9]{2}")}}),f.length&&(e.reverse(),a.each(e,function(a,b){c=c.replace(b.character,"("+f[f.length-a-1]+")")}),f=new RegExp("^"+c+"$","ig"),h=f.exec(b))){var j,k=new Date,l=k.getDate(),m=k.getMonth()+1,n=k.getFullYear(),o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=["January","February","March","April","May","June","July","August","September","October","November","December"],q=!0;if(e.reverse(),a.each(e,function(b,c){if(!q)return!0;switch(c.character){case"m":case"n":m=eb(h[b+1]);break;case"d":case"j":l=eb(h[b+1]);break;case"D":case"l":case"F":case"M":j="D"==c.character||"l"==c.character?O.settings.days:O.settings.months,q=!1,a.each(j,function(a,d){if(q)return!0;if(h[b+1].toLowerCase()==d.substring(0,"D"==c.character||"M"==c.character?3:d.length).toLowerCase()){switch(c.character){case"D":h[b+1]=o[a].substring(0,3);break;case"l":h[b+1]=o[a];break;case"F":h[b+1]=p[a],m=a+1;break;case"M":h[b+1]=p[a].substring(0,3),m=a+1}q=!0}});break;case"Y":n=eb(h[b+1]);break;case"y":n="19"+eb(h[b+1])}}),q){var r=new Date(n,(m||1)-1,l||1);if(r.getFullYear()==n&&r.getDate()==(l||1)&&r.getMonth()==(m||1)-1)return r}}return!1}},S=function(a){"firefox"==hb.name?a.css("MozUserSelect","none"):"explorer"==hb.name?a.bind("selectstart",function(){return!1}):a.mousedown(function(){return!1})},T=function(a){return a.replace(/([-.,*+?^${}()|[\]\/\\])/g,"\\$1")},U=function(b){for(var c="",d=b.getDate(),e=b.getDay(),f=O.settings.days[e],g=b.getMonth()+1,h=O.settings.months[g-1],i=b.getFullYear()+"",j=0;j<O.settings.format.length;j++){var k=O.settings.format.charAt(j);switch(k){case"y":i=i.substr(2);case"Y":c+=i;break;case"m":g=db(g,2);case"n":c+=g;break;case"M":h=a.isArray(O.settings.months_abbr)&&void 0!==O.settings.months_abbr[g-1]?O.settings.months_abbr[g-1]:O.settings.months[g-1].substr(0,3);case"F":c+=h;break;case"d":d=db(d,2);case"j":c+=d;break;case"D":f=a.isArray(O.settings.days_abbr)&&void 0!==O.settings.days_abbr[e]?O.settings.days_abbr[e]:O.settings.days[e].substr(0,3);case"l":c+=f;break;case"N":e++;case"w":c+=e;break;case"S":c+=d%10==1&&"11"!=d?"st":d%10==2&&"12"!=d?"nd":d%10==3&&"13"!=d?"rd":"th";break;default:c+=k}}return c},V=function(){var b=new Date(s,r+1,0).getDate(),c=new Date(s,r,1).getDay(),d=new Date(s,r,0).getDate(),e=c-O.settings.first_day_of_week;e=0>e?7+e:e,_(O.settings.header_captions.days);var f="<tr>";O.settings.show_week_number&&(f+="<th>"+O.settings.show_week_number+"</th>");for(var g=0;7>g;g++)f+="<th>"+(a.isArray(O.settings.days_abbr)&&void 0!==O.settings.days_abbr[(O.settings.first_day_of_week+g)%7]?O.settings.days_abbr[(O.settings.first_day_of_week+g)%7]:O.settings.days[(O.settings.first_day_of_week+g)%7].substr(0,2))+"</th>";for(f+="</tr><tr>",g=0;42>g;g++){g>0&&g%7===0&&(f+="</tr><tr>"),g%7===0&&O.settings.show_week_number&&(f+='<td class="dp_week_number">'+gb(new Date(s,r,g-e+1))+"</td>");var i=g-e+1;if(O.settings.select_other_months&&(e>g||i>b)){var j=new Date(s,r,i),k=j.getFullYear(),o=j.getMonth(),p=j.getDate();j=k+db(o+1,2)+db(p,2)}if(e>g)f+='<td class="'+(O.settings.select_other_months&&!Z(k,o,p)?"dp_not_in_month_selectable date_"+j:"dp_not_in_month")+'">'+(O.settings.select_other_months||O.settings.show_other_months?db(d-e+g+1,O.settings.zero_pad?2:0):"&nbsp;")+"</td>";else if(i>b)f+='<td class="'+(O.settings.select_other_months&&!Z(k,o,p)?"dp_not_in_month_selectable date_"+j:"dp_not_in_month")+'">'+(O.settings.select_other_months||O.settings.show_other_months?db(i-b,O.settings.zero_pad?2:0):"&nbsp;")+"</td>";else{var q=(O.settings.first_day_of_week+g)%7,w="";Z(s,r,i)?(a.inArray(q,O.settings.weekend_days)>-1?w="dp_weekend_disabled":w+=" dp_disabled",r==l&&s==m&&n==i&&(w+=" dp_disabled_current")):(a.inArray(q,O.settings.weekend_days)>-1&&(w="dp_weekend"),r==u&&s==v&&t==i&&(w+=" dp_selected"),r==l&&s==m&&n==i&&(w+=" dp_current")),f+="<td"+(""!==w?' class="'+a.trim(w)+'"':"")+">"+(O.settings.zero_pad?db(i,2):i)+"</td>"}}f+="</tr>",h.html(a(f)),O.settings.always_visible&&(E=a("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked, .dp_week_number)",h)),h.show()},W=function(){_(O.settings.header_captions.months);for(var b="<tr>",c=0;12>c;c++){c>0&&c%3===0&&(b+="</tr><tr>");var d="dp_month_"+c;Z(s,c)?d+=" dp_disabled":u!==!1&&u==c&&s==v?d+=" dp_selected":l==c&&m==s&&(d+=" dp_current"),b+='<td class="'+a.trim(d)+'">'+(a.isArray(O.settings.months_abbr)&&void 0!==O.settings.months_abbr[c]?O.settings.months_abbr[c]:O.settings.months[c].substr(0,3))+"</td>"}b+="</tr>",i.html(a(b)),O.settings.always_visible&&(F=a("td:not(.dp_disabled)",i)),i.show()},X=function(){_(O.settings.header_captions.years);for(var b="<tr>",c=0;12>c;c++){c>0&&c%3===0&&(b+="</tr><tr>");var d="";Z(s-7+c)?d+=" dp_disabled":v&&v==s-7+c?d+=" dp_selected":m==s-7+c&&(d+=" dp_current"),b+="<td"+(""!==a.trim(d)?' class="'+a.trim(d)+'"':"")+">"+(s-7+c)+"</td>"}b+="</tr>",j.html(a(b)),O.settings.always_visible&&(G=a("td:not(.dp_disabled)",j)),j.show()},Y=function(b){if("explorer"==hb.name&&6==hb.version){if(!y){var c=eb(e.css("zIndex"))-1;y=jQuery("<iframe>",{src:'javascript:document.write("")',scrolling:"no",frameborder:0,css:{zIndex:c,position:"absolute",top:-1e3,left:-1e3,width:e.outerWidth(),height:e.outerHeight(),filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)",display:"none"}}),a("body").append(y)}switch(b){case"hide":y.hide();break;default:var d=e.offset();y.css({top:d.top,left:d.left,display:"block"})}}},Z=function(b,c,d){if((void 0===b||isNaN(b))&&(void 0===c||isNaN(c))&&(void 0===d||isNaN(d)))return!1;if(a.isArray(O.settings.direction)||0!==eb(O.settings.direction)){var e=eb(cb(b,"undefined"!=typeof c?db(c,2):"","undefined"!=typeof d?db(d,2):"")),f=(e+"").length;if(8==f&&("undefined"!=typeof z&&e<eb(cb(p,db(o,2),db(q,2)))||"undefined"!=typeof A&&e>eb(cb(C,db(D,2),db(B,2)))))return!0;if(6==f&&("undefined"!=typeof z&&e<eb(cb(p,db(o,2)))||"undefined"!=typeof A&&e>eb(cb(C,db(D,2)))))return!0;if(4==f&&("undefined"!=typeof z&&p>e||"undefined"!=typeof A&&e>C))return!0}"undefined"!=typeof c&&(c+=1);var g=!1,h=!1;return x&&a.each(x,function(){if(!g){var e=this;if((a.inArray(b,e[2])>-1||a.inArray("*",e[2])>-1)&&("undefined"!=typeof c&&a.inArray(c,e[1])>-1||a.inArray("*",e[1])>-1)&&("undefined"!=typeof d&&a.inArray(d,e[0])>-1||a.inArray("*",e[0])>-1)){if("*"==e[3])return g=!0;var f=new Date(b,c-1,d).getDay();if(a.inArray(f,e[3])>-1)return g=!0}}}),w&&a.each(w,function(){if(!h){var e=this;if((a.inArray(b,e[2])>-1||a.inArray("*",e[2])>-1)&&(h=!0,"undefined"!=typeof c))if(h=!0,a.inArray(c,e[1])>-1||a.inArray("*",e[1])>-1){if("undefined"!=typeof d)if(h=!0,a.inArray(d,e[0])>-1||a.inArray("*",e[0])>-1){if("*"==e[3])return h=!0;var f=new Date(b,c-1,d).getDay();if(a.inArray(f,e[3])>-1)return h=!0;h=!1}else h=!1}else h=!1}}),w&&h?!1:x&&g?!0:!1},$=function(a){return(a+"").match(/^\-?[0-9]+$/)?!0:!1},_=function(b){if(a.isNumeric(r)&&(b=b.replace(/\bm\b/,db(r+1,2)).replace(/\bn\b/,r+1).replace(/\bF\b/,O.settings.months[r]).replace(/\bM\b/,a.isArray(O.settings.months_abbr)&&void 0!==O.settings.months_abbr[r]?O.settings.months_abbr[r]:O.settings.months[r].substr(0,3))),a.isNumeric(s)&&(b=b.replace(/\bY\b/,s).replace(/\by\b/,(s+"").substr(2)).replace(/\bY1\b/i,s-7).replace(/\bY2\b/i,s+4)),a(".dp_caption",g).html(b),a.isArray(O.settings.direction)||0!==eb(O.settings.direction)||1==H.length&&"months"==H[0]){var c,e,f=s,h=r;"days"==d?(e=!Z(0>h-1?cb(f-1,"11"):cb(f,db(h-1,2))),c=!Z(h+1>11?cb(f+1,"00"):cb(f,db(h+1,2)))):"months"==d?((!z||z.getFullYear()<=f-1)&&(e=!0),(!A||A.getFullYear()>=f+1)&&(c=!0)):"years"==d&&((!z||z.getFullYear()<f-7)&&(e=!0),(!A||A.getFullYear()>f+4)&&(c=!0)),e?a(".dp_previous",g).removeClass("dp_blocked"):(a(".dp_previous",g).addClass("dp_blocked"),a(".dp_previous",g).removeClass("dp_hover")),c?a(".dp_next",g).removeClass("dp_blocked"):(a(".dp_next",g).addClass("dp_blocked"),a(".dp_next",g).removeClass("dp_hover"))}},ab=function(){if(""===h.text()||"days"==d){if(""===h.text()){O.settings.always_visible||e.css("left",-1e3),e.show(),V();var b=h.outerWidth(),c=h.outerHeight();i.css({width:b,height:c}),j.css({width:b,height:c}),g.css("width",b),K.css("width",b),e.hide()}else V();i.hide(),j.hide()}else"months"==d?(W(),h.hide(),j.hide()):"years"==d&&(X(),h.hide(),i.hide());if(O.settings.onChange&&"function"==typeof O.settings.onChange&&void 0!==d){var f="days"==d?h.find("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked)"):"months"==d?i.find("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked)"):j.find("td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_blocked)");f.each(function(){if("days"==d)if(a(this).hasClass("dp_not_in_month_selectable")){var b=a(this).attr("class").match(/date\_([0-9]{4})(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])/);a(this).data("date",b[1]+"-"+b[2]+"-"+b[3])}else a(this).data("date",s+"-"+db(r+1,2)+"-"+db(eb(a(this).text()),2));else if("months"==d){var b=a(this).attr("class").match(/dp\_month\_([0-9]+)/);a(this).data("date",s+"-"+db(eb(b[1])+1,2))}else a(this).data("date",eb(a(this).text()))}),O.settings.onChange.call(P,d,f,P)}K.show(),O.settings.show_clear_date===!0||0===O.settings.show_clear_date&&""!==P.val()||O.settings.always_visible&&O.settings.show_clear_date!==!1?(k.show(),L?(J.css("width","50%"),k.css("width","50%")):(J.hide(),k.css("width","100%"))):(k.hide(),L?J.show().css("width","100%"):K.hide())},bb=function(a,b,c,d,e){var f=new Date(a,b,c,12,0,0),g="days"==d?E:"months"==d?F:G,h=U(f);P.val(h),O.settings.always_visible&&(u=f.getMonth(),r=f.getMonth(),v=f.getFullYear(),s=f.getFullYear(),t=f.getDate(),g.removeClass("dp_selected"),e.addClass("dp_selected"),"days"==d&&e.hasClass("dp_not_in_month_selectable")&&O.show()),O.hide(),fb(f),O.settings.onSelect&&"function"==typeof O.settings.onSelect&&O.settings.onSelect.call(P,h,a+"-"+db(b+1,2)+"-"+db(c,2),f,P,gb(f)),P.focus()},cb=function(){for(var a="",b=0;b<arguments.length;b++)a+=arguments[b]+"";return a},db=function(a,b){for(a+="";a.length<b;)a="0"+a;return a},eb=function(a){return parseInt(a,10)},fb=function(b){O.settings.pair&&a.each(O.settings.pair,function(){var c=a(this);if(c.data&&c.data("Zebra_DatePicker")){var d=c.data("Zebra_DatePicker");d.update({reference_date:b,direction:0===d.settings.direction?1:d.settings.direction}),d.settings.always_visible&&d.show()}else c.data("zdp_reference_date",b)})},gb=function(a){var b,c,d,e,f,g,h,i,j,k=a.getFullYear(),l=a.getMonth()+1,m=a.getDate();return 3>l?(b=k-1,c=(b/4|0)-(b/100|0)+(b/400|0),d=((b-1)/4|0)-((b-1)/100|0)+((b-1)/400|0),e=c-d,f=0,g=m-1+31*(l-1)):(b=k,c=(b/4|0)-(b/100|0)+(b/400|0),d=((b-1)/4|0)-((b-1)/100|0)+((b-1)/400|0),e=c-d,f=e+1,g=m+((153*(l-3)+2)/5|0)+58+e),h=(b+c)%7,m=(g+h-f)%7,i=g+3-m,j=0>i?53-((h-e)/5|0):i>364+e?1:(i/7|0)+1},hb={init:function(){this.name=this.searchString(this.dataBrowser)||"",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||""},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(this.versionSearchString=a[b].versionSearch||a[b].identity,c){if(-1!=c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);return-1!=b?parseFloat(a.substring(b+this.versionSearchString.length+1)):void 0},dataBrowser:[{string:navigator.userAgent,subString:"Firefox",identity:"firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"explorer",versionSearch:"MSIE"}]};hb.init(),Q()},a.fn.Zebra_DatePicker=function(b){return this.each(function(){void 0!==a(this).data("Zebra_DatePicker")&&a(this).data("Zebra_DatePicker").destroy();var c=new a.Zebra_DatePicker(this,b);a(this).data("Zebra_DatePicker",c)})}}(jQuery),function(a){a.Zebra_Form=function(b,c){var d=this,e={scroll_to_error:!0,tips_position:"left",close_tips:!0,validate_on_the_fly:!1,validate_all:!1,assets_path:null};d.settings={};var f,g,h={},i={},j={},k=[],l={},m={},n=!1,o=!1,p=a(b);d.filter_input=function(a,b,c){var d,e="";if(window.event)d=window.event.keyCode,b=window.event;else{if(!b)return!0;d=b.which}switch(a){case"alphabet":e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";break;case"digits":case"number":case"float":e="0123456789";break;case"alphanumeric":e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";break;default:return!0}return c&&(e+=c),c=b.srcElement?b.srcElement:b.target||b.currentTarget,null==d||0==d||8==d||9==d||13==d||27==d?!0:(d=String.fromCharCode(d),("v"==d||"a"==d||"c"==d||"x"==d)&&b.ctrlKey||-1<e.indexOf(d)||"number"==a&&"-"==d&&0==s(c)||"float"==a&&("-"==d&&0==s(c)||"."==d&&0!=s(c)&&null==c.value.match(/\./))?!0:!1)},d.init=function(){d.settings=a.extend({},e,c),p.find("option.dummy").remove(),a("div.error",p).each(function(){a("div.close a",a(this)).bind("click",function(b){b.preventDefault(),a(this).closest("div.error").animate({height:0,opacity:0},250,function(){a(this).remove()})})}),g=a(".control",p),g.each(function(){var b=a(this),c={id:b.attr("id"),name:b.attr("name"),type:x(b)},e=b.closest(".row");if(void 0!=c.name&&(c.name=c.name.replace(/\[\]$/,"")),e.length&&b.bind({focus:function(){e.addClass("highlight")},blur:function(){e.removeClass("highlight")}}),b.hasClass("inside")&&("text"==c.type||"password"==c.type||"textarea"==c.type)||b.hasClass("show-character-counter")||("text"==c.type||"password"==c.type)&&b.data("prefix"))var f=jQuery('<span class="Zebra_Form_Wrapper"></span>').css({display:b.css("display"),position:"static"==b.css("position")?"relative":b.css("position"),"float":b.css("float"),top:b.css("top"),right:b.css("right"),bottom:b.css("bottom"),left:b.css("left")}),b=b.replaceWith(f).css({position:"relative",top:"auto",right:"auto",bottom:"auto",left:"auto"}).appendTo(f);if(!b.hasClass("inside")||"text"!=c.type&&"password"!=c.type&&"textarea"!=c.type)b.hasClass("other")&&"select-one"==c.type&&(v(b),b.change(function(){v(b)}));else{var f=b.position(),g="text"==c.type||"password"==c.type?jQuery("<input>").attr({type:"text","class":"Zebra_Form_Placeholder",autocomplete:"off",value:b.attr("title")}):jQuery("<textarea>").attr({"class":"Zebra_Form_Placeholder",autocomplete:"off"}).html(b.attr("title"));"password"==c.type&&b.css("fontFamily","inherit"),g.css({fontFamily:b.css("fontFamily"),fontSize:b.css("fontSize"),fontStyle:b.css("fontStyle"),fontWeight:b.css("fontWeight"),left:f.left,top:f.top,width:parseInt(b.css("width"),10)+(parseInt(b.css("borderLeftWidth"),10)||0)+(parseInt(b.css("borderRightWidth"),10)||0),height:parseInt(b.css("height"),10)+(parseInt(b.css("borderTopWidth"),10)||0)+(parseInt(b.css("borderBottomWidth"),10)||0),paddingTop:parseInt(b.css("paddingTop"),10)||0,paddingRight:parseInt(b.css("paddingRight"),10)||0,paddingBottom:parseInt(b.css("paddingBottom"),10)||0,paddingLeft:parseInt(b.css("paddingLeft"),10)||0,marginTop:parseInt(b.css("marginTop"),10)||0,marginRight:parseInt(b.css("marginRight"),10)||0,marginBottom:parseInt(b.css("marginBottom"),10)||0,marginLeft:parseInt(b.css("marginLeft"),10)||0}).insertAfter(b).hide(),b.removeAttr("title"),g.bind("focus",function(){b.focus()}),b.bind({focus:function(){g.hide()},blur:function(){""==a(this).val()&&g.show()}}),b.data("Zebra_Form_Placeholder",g),k.push(b),"password"==c.type&&b.css({fontFamily:"Verdana, Tahoma, Arial"})}if("undefined"!=typeof d.settings.validation_rules[c.name]&&d.register(b,!1),("text"==c.type||"textarea"==c.type||"password"==c.type)&&b.attr("maxlength")&&(b.data("maxlength",b.attr("maxlength")),b.bind("keyup",function(b){b=a(this);var c=b.data("maxlength"),d=t(b);b.attr("maxlength",c-d),b.hasClass("show-character-counter")&&(b=c-d-b.val().length,h.html(0>b?"<span>"+b+"</span>":b))}),b.hasClass("show-character-counter"))){var f=b.position(),h=jQuery("<div>",{"class":"Zebra_Character_Counter",css:{visibility:"hidden"}}).html(b.data("maxlength")).insertAfter(b);width=h.outerWidth(),height=h.outerHeight(),h.css({top:f.top+b.outerHeight()-height/1.5,left:f.left+b.outerWidth()-width/1.5,width:h.width(),visibility:"visible"}),b.trigger("keyup")}"text"!=c.type&&"password"!=c.type||!b.data("prefix")||(c=b.data("prefix"),f=decodeURIComponent(c.replace(/\+/g," ")).match(/^img\:(.*)/i),c=null!=f?jQuery("<img>",{src:f[1]}):jQuery("<div>",{css:{fontFamily:b.css("fontFamily"),fontSize:b.css("fontSize")}}).html(decodeURIComponent(c.replace(/\+/g," "))),c.attr({"class":"Zebra_Form_Input_Prefix"}).css({visibility:"hidden",position:"absolute"}).insertAfter(b),c.css({top:(b.outerHeight()-c.outerHeight())/2,left:parseInt(b.css("paddingLeft"),10),visibility:"visible"}),b.css({paddingLeft:"+="+c.outerWidth(!0)}),"border-box"!=b.css("boxSizing")&&b.css({width:"-="+c.outerWidth(!0)}),void 0!=g&&g.css({left:"+="+c.outerWidth(!0)}))}),a("input.submit, input.image",p).bind("click",function(){p.data("zf_clicked_button",a(this).attr("id"))});for(var h in d.settings.validation_rules)for(var i in d.settings.validation_rules[h])"dependencies"==i&&function(){var c=d.settings.validation_rules[h][i];"string"==typeof c[1]&&(c=c[0]);for(var e in c){var f=a('input[name="'+e+'"],select[name="'+e+'"],textarea[name="'+e+'"]',b);if(0==f.length&&(f=a('input[name="'+e+'[]"],select[name="'+e+'[]"],textarea[name="'+e+'[]"]',b)),0<f.length){l[e]||(l[e]={conditions:{},elements:[],event:!1}),-1==a.inArray(h,l[e].elements)&&l[e].elements.push(h);var g=w(c[e]),j=x(a(f[0]));l[e].conditions[g]||(l[e].conditions[g]=function(){var b=c[e],d=[];f.each(function(){switch(j){case"radio":case"checkbox":this.checked&&d.push(a(this).val());break;case"image":case"submit":p.data("zf_clicked_button")==a(this).attr("id")&&d.push("click");break;default:d.push(a(this).val())}});var g=!1;return 0<d.length&&(a.isArray(b)?a.each(b,function(c){var e=0;a.each(d,function(f){a.isArray(b[c])||d[f]!=b[c]?a.isArray(b[c])&&-1<a.inArray(d[f],b[c])&&e++:g=!0}),g||e!=b[c].length||(g=!0)}):a.each(d,function(a){b==d[a]&&(g=!0)})),g})}}0<f.length&&0==l[e].event&&(l[e].event=function(){a.each(l[e].elements,function(b){var c=d.settings.validation_rules[l[e].elements[b]].dependencies,f=!0;if("string"==typeof c[1]){var g=c[1].split(","),g=a.map(g,function(b){return a.trim(b)}),h=g.shift();arguments=g,c=c[0]}for(var i in c)g=w(c[i]),l[i].conditions[g]()||(f=!1);if(void 0!=c[e]&&void 0!=h){for(c=window,h=h.split("."),i=h.pop(),g=0;g<h.length;g++){if(void 0==c[h[g]])throw Error('"'+h[g]+"\" namespace doesn't exist in the global scope!");c=c[h[g]]}try{c[i].apply(void 0,[f].concat(arguments))}catch(j){throw Error('"'+i+'" callback function was not found!')}}})},f.bind("checkbox"==j||"radio"==j||"select-multiple"==j||"submit"==j||"button"==j?"click":"select-one"==j?"change":"blur",l[e].event)),f.length&&l[e].event()}();var j=a(".captcha-container");if(0<j.length){var m=a("img",j);a("a",j).bind("click",function(a){a.preventDefault(),m.attr("src",m.attr("src").replace(/nocache=[0-9]+/,"nocache="+(new Date).getTime()))})}p.bind("submit",function(a){0!=n||void 0==d.settings.validation_rules||o||d.validate()||a.preventDefault(),o=!1}),0<k.length&&setInterval(q,50),f={init:function(){this.name=this.searchString(this.dataBrowser)||"",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||""},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(this.versionSearchString=a[b].versionSearch||a[b].identity,c){if(-1!=c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);return-1!=b?parseFloat(a.substring(b+this.versionSearchString.length+1)):void 0},dataBrowser:[{string:navigator.userAgent,subString:"Firefox",identity:"firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"explorer",versionSearch:"MSIE"}]},f.init()},d.attach_tip=function(a,b){var c=a.attr("id");void 0==h[c]&&(h[c]={element:a}),h[c].message=b,d.show_errors(a)},d.clear_errors=function(){a(".Zebra_Form_error_iFrameShim").remove(),a(".Zebra_Form_error_message").remove(),g.removeClass("error"),j={}},d.end_file_upload=function(b,c){var e=a("#"+b);if(e.length&&(d.clear_errors(),p.removeAttr("target"),setTimeout(function(){a("#"+b+"_iframe").remove()},1e3),a("#"+b+"_spinner").remove(),void 0!=h[b]))if(void 0!=c&&"object"==typeof c&&void 0!=c[0]&&void 0!=c[1]&&void 0!=c[2]&&void 0!=c[3]&&e.data("file_info",c),!0!==d.validate_control(e))e.val(""),e.css("visibility","visible"),d.show_errors(e),e.data("file_info","");
else{var f=e.offset(),g=jQuery("<div>",{"class":"Zebra_Form_filename",css:{left:f.left,top:f.top,width:e.outerWidth(),opacity:0}}).html(c[0]),f=jQuery("<a>",{href:"javascript:void(0)"}).html("x").bind("click",function(a){a.preventDefault(),g.remove(),e.val(""),e.data("file_info")&&e.removeData("file_info"),e.css("visibility","visible")});a("body").append(g.append(f)),g.css({top:parseInt(g.css("top"),10)+(e.outerHeight()-g.outerHeight())/2,opacity:1})}},d.hide_error=function(b,c){var e=a("#"+b);if(void 0==c&&d.settings.validate_on_the_fly&&!0!==d.validate_control(e))d.show_errors(e,!1);else{var f=a("#Zebra_Form_error_message_"+b);0<f.length&&(e.removeClass("error"),f.animate({opacity:0},250,function(){var a=f.data("shim");void 0!=a&&a.remove(),f.remove(),delete j[b]}))}},d.register=function(b,c){var e={id:b.attr("id"),name:b.attr("name"),type:x(b)};if(void 0!=e.name){switch(e.name=e.name.replace(/\[\]$/,""),b.hasClass("time")&&(e.name=e.name.replace(/\_(hours|minutes|seconds|ampm)$/,"")),e.type){case"radio":case"checkbox":b.bind({click:function(){d.hide_error(e.name)},blur:function(){d.hide_error(e.name)}}),void 0==i[e.id]&&(i[e.id]=p.find("input[name^="+e.name+"]"));break;case"file":var f=b.clone(!0);f.attr("value",""),b.replaceWith(f),f.bind({keypress:function(){f.attr("value","")},change:function(){if(void 0!=h[e.name].rules.upload){d.hide_error(e.name),f.data("file_info")&&f.removeData("file_info");var c=jQuery('<iframe id="'+e.id+'_iframe" name="'+e.id+'_iframe">',{src:"javascript:void(0)",scrolling:"no",marginwidth:0,marginheight:0,width:0,height:0,frameborder:0,allowTransparency:"true"}).css({position:"absolute",top:0,left:-1e3});a("body").append(c),c=p.attr("action"),p.attr("action",decodeURIComponent(d.settings.assets_path)+"process.php?form="+p.attr("id")+"&control="+e.id+"&path="+encodeURIComponent(decodeURIComponent(h[e.name].rules.upload[0]))+"&nocache="+(new Date).getTime()),p.attr("target",e.id+"_iframe"),b.css("visibility","hidden");var g=b.offset(),g=jQuery("<div>",{id:e.id+"_spinner","class":"Zebra_Form_spinner",css:{left:g.left,top:g.top}});a("body").append(g),n=!0,p.trigger("submit"),p.attr("action",c),n=!1}},blur:function(){d.hide_error(e.name)}}),b=f;break;case"select-one":case"select-multiple":b.bind({change:function(){d.hide_error(e.name)},blur:function(){d.hide_error(e.name)}});break;default:b.blur(function(){var a=e.name;if("text"==e.type&&b.hasClass("other")){var c=e.id.match(/^(.*)\_other$/);null!=c&&(a=c[1])}d.hide_error(a)})}var j=d.settings.validation_rules[e.name];if(null!=j)if(void 0==c)g=a(".control",p),a.each(g,function(c,d){if(d==b.get(0)){a(d);for(var f=null,i=c-1;null==f&&void 0!=g[i];)f=a(g[i]).attr("id"),i--;if(h[f]){i={};for(c in h)i[c]=h[c],f==c&&(i[e.id]={element:b,rules:j});h=i}else f={},f[e.id]={element:b,rules:j},a.extend(h,f)}});else if(void 0!=c&&a("#"+c).length){a("#"+c).attr("id");var k={};for(index in h)k[index]=h[index],previous_element_id==index&&(k[e.id]={element:b,rules:j});h=k}else void 0!=c&&!1===c&&(h[e.id]={element:b,rules:j})}},d.show_errors=function(b,c){void 0!=c&&!1===c||d.clear_errors();var e=0;for(index in h){var g=h[index],i=g.element,k={id:i.attr("id"),name:i.attr("name"),type:x(i)},l="radio"==k.type||"checkbox"==k.type?k.name.replace(/\[\]$/,""):k.id;if(i.hasClass("time")&&(l=k.name.replace(/\_(hours|minutes|seconds|ampm)$/,"")),(void 0==b||b.get(0)==i.get(0))&&void 0!=g.message&&void 0==j[l]){"none"==i.css("display")||void 0!=c&&!1===c||d.settings.validate_all&&e>0||i.focus();var m=a.extend(i.offset()),m=a.extend(m,{right:Math.floor(m.left+i.width())}),n=jQuery("<div/>",{"class":"Zebra_Form_error_message",id:"Zebra_Form_error_message_"+l,css:{opacity:0}}),g=jQuery("<div/>",{"class":"message"+(d.settings.close_tips?"":" noclose"),css:{_width:"auto"}}).html(g.message).appendTo(n);d.settings.close_tips&&jQuery("<a/>",{href:"javascript:void(0)","class":"close"+("explorer"==f.name&&6==f.version?"-ie6":"")}).html("x").appendTo(g).bind({click:function(b){b.preventDefault(),d.hide_error(a(this).closest("div.Zebra_Form_error_message").attr("id").replace(/^Zebra\_Form\_error\_message\_/,""),!0)},focus:function(){a(this).blur()}});var o=jQuery("<div/>",{"class":"arrow"}).appendTo(n);a("body").append(n);var p=n.outerWidth(),q=n.outerHeight(),q=o.outerWidth(),g=o.outerHeight(),r=("left"==d.settings.tips_position?m.left:m.right)-p/2;if(o.css("left",p/2-q/2-1),("radio"==k.type||"checkbox"==k.type)&&(r=m.right-p/2-i.outerWidth()/2+1),0>r&&(r=2),n.css("left",r),p=n.outerWidth(),q=n.outerHeight(),m=m.top-q+g/2-1,0>m&&(m=2),n.css({left:r+"px",top:m+"px",height:q-g/2+"px"}),j[l]=n,u(n),n.animate({opacity:.9},250),1!=++e||!d.settings.scroll_to_error||void 0!=c&&!1===c||a("html, body").animate({scrollTop:Math.max(parseInt(n.css("top"),10)+parseInt(n.css("height"),10)/2-a(window).height()/2,0)},0),"file"!=k.type&&i.addClass("error"),!d.settings.validate_all)break}}},d.submit=function(){p.trigger("submit")},d.validate_control=function(b){var c={id:b.attr("id"),name:b.attr("name"),type:x(b)},e=!0,f=h[c.id],g="radio"==c.type||"checkbox"==c.type?c.name.replace(/\[\]$/,""):c.id;if(b.hasClass("time")&&(g=c.name.replace(/\_(hours|minutes|seconds|ampm)$/,"")),void 0!=f&&("none"!=b.css("display")&&"hidden"!=b.css("visibility")||b.data("file_info"))){var j=null;delete f.message;for(var k in f.rules){if(!e)break;switch(k){case"alphabet":switch(c.type){case"password":case"text":case"textarea":var l=new RegExp("^[a-z"+r(f.rules[k][0]).replace(/\s/,"\\s")+"]+$","ig");""==a.trim(b.val())||l.test(b.val())||(e=!1)}break;case"alphanumeric":switch(c.type){case"password":case"text":case"textarea":l=new RegExp("^[a-z0-9"+r(f.rules[k][0]).replace(/\s/,"\\s")+"]+$","ig"),""==a.trim(b.val())||l.test(b.val())||(e=!1)}break;case"compare":switch(c.type){case"password":case"text":case"textarea":a("#"+f.rules[k][0])&&b.val()==a("#"+f.rules[k][0]).val()||(e=!1)}break;case"dependencies":if(!y(g))return!0;break;case"custom":var m=!1;a.each(f.rules[k],function(c,d){if(!m){d=a.merge(a.merge([d[0]],[b.val()]),d.slice(1));var f="function"==typeof d[0]?d[0]:"function"==typeof window[d[0]]?window[d[0]]:!1;if(!1===f)throw e=!1,Error('Function "'+d[0]+"\" doesn't exist!");e=f.apply(f,d.slice(1)),e||(custom_rule_error_message=d[d.length-1],m=!0)}});break;case"date":switch(c.type){case"text":if(""!=a.trim(b.val())){for(var l=!1,n=b.data("Zebra_DatePicker").settings.format,o="dDjlNSwFmMnYyGHghaAisU".split(""),p=[],q=[],n=r(n),s=0;s<o.length;s++)-1<(position=n.indexOf(o[s]))&&p.push({character:o[s],position:position});if(p.sort(function(a,b){return a.position-b.position}),a.each(p,function(a,b){switch(b.character){case"d":q.push("0[1-9]|[12][0-9]|3[01]");break;case"D":q.push("[a-z]{3}");break;case"j":q.push("[1-9]|[12][0-9]|3[01]");break;case"l":q.push("[a-z]+");break;case"N":q.push("[1-7]");break;case"S":q.push("st|nd|rd|th");break;case"w":q.push("[0-6]");break;case"F":q.push("[a-z]+");break;case"m":q.push("0[1-9]|1[012]+");break;case"M":q.push("[a-z]{3}");break;case"n":q.push("[1-9]|1[012]");break;case"Y":q.push("[0-9]{4}");break;case"y":q.push("[0-9]{2}");break;case"G":q.push("[0-9]|1[0-9]|2[0-3]");break;case"H":q.push("0[0-9]|1[0-9]|2[0-3]");break;case"g":q.push("[0-9]|1[0-2]");break;case"h":q.push("0[0-9]|1[0-2]");break;case"a":case"A":q.push("(am|pm)");break;case"i":q.push("[0-5][0-9]");break;case"s":q.push("[0-5][0-9]")}}),0<q.length&&(p.reverse(),a.each(p,function(a,b){n=n.replace(b.character,"("+q[q.length-a-1]+")")}),q=new RegExp("^"+n+"$","ig"),segments=q.exec(b.val()))){var u=null,v=null,w=null,z="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),A="January February March April May June July August September October November December".split(" "),B=null,C=!0;p.reverse(),a.each(p,function(c,d){if(!C)return!0;switch(d.character){case"m":case"n":v=parseInt(segments[c+1],10);break;case"d":case"j":u=parseInt(segments[c+1],10);break;case"D":case"l":case"F":case"M":B="D"==d.character||"l"==d.character?b.data("Zebra_DatePicker").settings.days:b.data("Zebra_DatePicker").settings.months,C=!1,a.each(B,function(a,b){if(C)return!0;if(segments[c+1].toLowerCase()==b.substring(0,"D"==d.character||"M"==d.character?3:b.length).toLowerCase()){switch(d.character){case"D":segments[c+1]=z[a].substring(0,3);break;case"l":segments[c+1]=z[a];break;case"F":segments[c+1]=A[a],v=a+1;break;case"M":segments[c+1]=A[a].substring(0,3),v=a+1}C=!0}});break;case"Y":w=parseInt(segments[c+1],10);break;case"y":w="19"+parseInt(segments[c+1],10)}}),C&&(u||(u=1),v||(v=1),o=new Date(w,v-1,u),o.getFullYear()==w&&o.getDate()==u&&o.getMonth()==v-1&&(b.data("timestamp",Date.parse(A[v-1]+" "+u+", "+w)),l=!0))}l||(e=!1)}}break;case"datecompare":switch(c.type){case"password":case"text":case"textarea":if(""!=a.trim(b.val()))if(void 0!=f.rules[k][0]&&void 0!=f.rules[k][1]&&a(f.rules[k][0])&&!0===d.validate_control(a(f.rules[k][0]))&&void 0!=b.data("timestamp"))switch(f.rules[k][1]){case">":e=b.data("timestamp")>a("#"+f.rules[k][0]).data("timestamp");break;case">=":e=b.data("timestamp")>=a("#"+f.rules[k][0]).data("timestamp");break;case"<":e=b.data("timestamp")<a("#"+f.rules[k][0]).data("timestamp");break;case"<=":e=b.data("timestamp")<=a("#"+f.rules[k][0]).data("timestamp")}else e=!1}break;case"digits":switch(c.type){case"password":case"text":case"textarea":l=new RegExp("^[0-9"+r(f.rules[k][0]).replace(/\s/,"\\s")+"]+$","ig"),""==a.trim(b.val())||l.test(b.val())||(e=!1)}break;case"email":switch(c.type){case"password":case"text":case"textarea":""!=a.trim(b.val())&&null==b.val().match(/^([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+@{1}([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+\.[A-Za-z0-9]{2,}$/)&&(e=!1)}break;case"emails":switch(c.type){case"password":case"text":case"textarea":l=b.val().split(","),a.each(l,function(b,c){""!=a.trim(c)&&null==a.trim(c).match(/^([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+@{1}([a-zA-Z0-9_\-\+\~\^\{\}]+[\.]?)+\.[A-Za-z0-9]{2,}$/)&&(e=!1)})}break;case"filesize":switch(c.type){case"file":var D=b.data("file_info");D&&(void 0==D[2]||void 0==D[3]||0!=D[2]||parseInt(D[3],10)>parseInt(f.rules[k][0],10))&&(e=!1)}break;case"filetype":switch(c.type){case"file":if(D=b.data("file_info")){void 0==d.mimes&&a.ajax({url:decodeURIComponent(d.settings.assets_path)+"mimes.json",async:!1,success:function(a){d.mimes=a},dataType:"json"});var E=a.map(f.rules[k][0].split(","),function(b){return a.trim(b)}),F=[];a.each(d.mimes,function(b,c){(a.isArray(c)&&-1<a.inArray(D[1],c)||!a.isArray(c)&&c==D[1])&&F.push(b)});var G=!1;a.each(F,function(b,c){-1<a.inArray(c,E)&&(G=!0)}),G||(e=!1)}}break;case"float":switch(c.type){case"password":case"text":case"textarea":l=new RegExp("^[0-9-."+r(f.rules[k][0]).replace(/\s/,"\\s")+"]+$","ig"),""!=a.trim(b.val())&&("-"==a.trim(b.val())||"."==a.trim(b.val())||null!=b.val().match(/\-/g)&&1<b.val().match(/\-/g).length||null!=b.val().match(/\./g)&&1<b.val().match(/\./g).length||0<b.val().indexOf("-")||!l.test(b.val()))&&(e=!1)}break;case"image":switch(c.type){case"file":(D=b.data("file_info"))&&null==D[1].match(/image\/(gif|jpeg|png|pjpeg)/i)&&(e=!1)}break;case"length":switch(c.type){case"password":case"text":case"textarea":(""!=b.val()&&void 0!=f.rules[k][0]&&b.val().length-t(b)<f.rules[k][0]||void 0!=f.rules[k][1]&&0<f.rules[k][1]&&b.val().length-t(b)>f.rules[k][1])&&(e=!1)}break;case"number":switch(c.type){case"password":case"text":case"textarea":l=new RegExp("^[0-9-"+r(f.rules[k][0]).replace(/\s/,"\\s")+"]+$","ig"),""!=a.trim(b.val())&&("-"==a.trim(b.val())||null!=b.val().match(/\-/g)&&1<b.val().match(/\-/g).length||0<b.val().indexOf("-")||!l.test(b.val()))&&(e=!1)}break;case"regexp":switch(c.type){case"password":case"text":case"textarea":l=new RegExp(f.rules[k][0],"g"),""!=a.trim(b.val())&&null==l.exec(b.val())&&(e=!1)}break;case"required":switch(c.type){case"checkbox":case"radio":var H=!1;i[c.id].each(function(){this.checked&&(H=!0)}),H||(e=!1);break;case"file":case"password":case"text":case"textarea":""==a.trim(b.val())&&(e=!1);break;case"select-one":b.hasClass("time")&&0==b.get(0).selectedIndex?(c.id=c.id.replace(/\_(hours|minutes|seconds|ampm)$/,""),e=!1):(b.hasClass("other")&&"other"==b.val()&&(!a("#"+c.id+"_other").length||""==a.trim(a("#"+c.id+"_other").val()))||0==b.get(0).selectedIndex)&&(e=!1);break;case"select-multiple":-1==b.get(0).selectedIndex&&(e=!1)}break;case"upload":switch(c.type){case"file":D=b.data("file_info"),!D||D[2]&&0==D[2]||(e=!1)}break;case"url":switch(c.type){case"password":case"text":case"textarea":l=new RegExp("^(http(s)?://)"+(!0===f.rules[k][0]?"":"?")+"[^\\s\\.]+\\..{2,}","i"),""==a.trim(b.val())||l.test(b.val())||(e=!1)}}e||(j=k,f.message="custom"==k?custom_rule_error_message:d.settings.validation_rules[g][j][d.settings.validation_rules[g][j].length-("length"==j&&4==d.settings.validation_rules[g][j].length?2:1)],f.value=b.val())}}return e?!0:j},d.validate=function(){var a,b=!0;d.clear_errors(),m={};for(index in h){if(!b&&!d.settings.validate_all)break;a=h[index].element,!0!==(rule_not_passed=d.validate_control(a))&&(b=!1)}return b||d.show_errors(),o=!0,b};var q=function(){a.each(k,function(){var b=a(this),c=b.data("Zebra_Form_Placeholder");""!=b.val()||b.is(":focus")?c.hide():c.show()})},r=function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},s=function(a){if(null!=a.selectionStart)return a.selectionStart;var b=document.selection.createRange(),c=b.duplicate();if("text"==a.type)return 0-c.moveStart("character",-1e5);var d=a.value.length;return c.moveToElementText(a),c.setEndPoint("StartToStart",b),d-c.text.length},t=function(a){a=a.val();var b=a.length;return a.replace(/(\r\n|\r|\n)/g,"\r\n").length-b},u=function(b){if("explorer"==f.name&&6==f.version&&!b.data("shim")){var c=b.offset(),d=parseInt(b.css("zIndex"),10)-1,c=jQuery("<iframe>",{src:'javascript:document.write("")',scrolling:"no",frameborder:0,allowTransparency:"true","class":"Zebra_Form_error_iFrameShim",css:{zIndex:d,position:"absolute",top:c.top,left:c.left,width:b.outerWidth(),height:b.outerHeight(),filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)",display:"block"}});a("body").append(c),b.data("shim",c)}},v=function(b){var c=a("#"+b.attr("id")+"_other");"other"==b.val()?c.css("display","block"):c.css("display","none")},w=function(b){if(!a.isArray(b))return b;var c="";return a.each(b,function(d){d=b[d],a.isArray(d)&&(d="|"+w(d)+"|"),c+=""+d}),c},x=function(a){var b="button input:checkbox input:file input:image input:password input:radio input:submit input:text select textarea".split(" ");for(index in b)if(a.is(b[index]))return"select"==b[index]?a.attr("multiple")?"select-multiple":"select-one":b[index].replace(/input\:/,"")},y=function(b,c){if(void 0==c&&(c=[]),2<c.length&&c.shift(),-1<a.inArray(b,c))throw Error('Infinite recursion detected. The loop of dependencies is created by the following elements: "'+c.join('", "')+'"');c.push(b);var e=d.settings.validation_rules[b].dependencies;"string"==typeof e[1]&&(e=e[0]);var f,g=!0;for(f in e){if(void 0!=m[f]&&void 0!=m[f][e[f]])g=m[f][e[f]];else{if(void 0!=d.settings.validation_rules[f]&&void 0!=d.settings.validation_rules[f].dependencies&&(g=y(f,c)),g){var h=w(e[f]);l[f]&&l[f].conditions[h]()||(g=!1)}void 0==m[f]&&(m[f]={}),void 0==m[f][e[f]]&&(m[f][e[f]]=g)}if(!g)break}return g};d.init()},a.fn.Zebra_Form=function(b){return this.each(function(){var c=new a.Zebra_Form(this,b);a(this).data("Zebra_Form",c),"function"==typeof c.settings.on_ready&&c.settings.on_ready()})}}(jQuery);